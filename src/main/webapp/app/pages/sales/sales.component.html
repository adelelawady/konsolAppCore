<div class="pos-container">
  <!-- Top Bar -->
  <div class="pos-header">
    <div class="row g-3">
      <!-- Search Box - Takes more space -->
      <div class="col-lg-6 col-md-8">
        <jhi-items-search-box (itemSelected)="onItemSelected($event)"></jhi-items-search-box>
      </div>

      <!-- Account Selection -->
      <div class="col-lg-6 col-md-4">
        <div class="d-flex align-items-center justify-content-end">
          <div class="form-check me-3">
            <input class="form-check-input" type="checkbox" [(ngModel)]="singleAccount" id="singleAccount" />
            <label class="form-check-label" for="singleAccount">حساب واحد</label>
          </div>
          <div class="d-flex align-items-center">
            <label class="me-2">حساب العميل</label>
            <select class="form-select" [(ngModel)]="selectedCustomer">
              <option value="">اختر العميل</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Totals Row -->
      <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
          <div class="total-item me-4">
            <span class="text-muted">الكمية</span>
            <h3 class="mb-0">{{ currentQuantity | number: '1.0-3' }}</h3>
          </div>
          <div class="total-item me-4">
            <span class="text-muted">السعر</span>
            <h3 class="mb-0">{{ currentPrice | number: '1.2-2' }} د.ل</h3>
          </div>
          <div class="total-item">
            <span class="text-muted">المجموع</span>
            <h3 class="mb-0">{{ currentTotal | number: '1.2-2' }} د.ل</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content - Items Table -->
  <div class="pos-content">
    <div class="table-responsive">
      <table class="table table-vcenter table-hover">
        <thead>
          <tr>
            <th class="text-center w-5">رقم</th>
            <th class="text-end w-25">اسم</th>
            <th class="text-center w-8">وحدة</th>
            <th class="text-center w-10">كميه</th>
            <th class="text-center w-12">سعر الوحده</th>
            <th class="text-center w-12">اجمالى السعر</th>
            <th class="text-center w-10">خصم</th>
            <th class="text-center w-10">صافى السعر</th>
            <th class="text-center w-8">اجراءات</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of saleItems; let i = index">
            <td class="text-center">{{ i + 1 }}</td>
            <td class="text-end">{{ item.name }}</td>
            <td class="text-center">{{ item.unit }}</td>
            <td class="text-center">
              <input
                type="number"
                class="form-control form-control-sm text-center"
                [(ngModel)]="item.quantity"
                (change)="updateQuantity(i, item.quantity)"
              />
            </td>
            <td class="text-center">{{ item.unitPrice | number: '1.2-2' }} د.ل</td>
            <td class="text-center">{{ item.totalPrice | number: '1.2-2' }} د.ل</td>
            <td class="text-center">
              <input
                type="number"
                class="form-control form-control-sm text-center"
                [(ngModel)]="item.discount"
                (change)="updateDiscount(i, item.discount)"
              />
            </td>
            <td class="text-center">{{ item.netPrice | number: '1.2-2' }} د.ل</td>
            <td class="text-center">
              <button class="btn btn-icon btn-sm btn-outline-danger" (click)="removeItem(i)">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="icon"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  stroke-width="2"
                  stroke="currentColor"
                  fill="none"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M18 6l-12 12" />
                  <path d="M6 6l12 12" />
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Bottom Bar -->
  <div class="pos-footer">
    <div class="d-flex justify-content-between align-items-center">
      <!-- Left Side - Store/Bank Selection -->
      <div class="d-flex align-items-center">
        <select class="form-select me-2" [(ngModel)]="selectedBank">
          <option value="Bank_1">Bank_1</option>
        </select>
        <select class="form-select me-2" [(ngModel)]="selectedStore">
          <option value="Store_1">Store_1</option>
        </select>
        <button class="btn btn-outline-secondary" (click)="toggleClickMode()">CLICK MODE</button>
      </div>

      <!-- Right Side - Total & Save -->
      <div class="d-flex align-items-center">
        <div class="total-section me-4">
          <div class="text-muted">خصم</div>
          <h3 class="mb-0">{{ totalDiscount | number: '1.2-2' }} د.ل</h3>
        </div>
        <div class="grand-total me-4">
          <h2 class="mb-0">{{ netTotal | number: '1.2-2' }} د.ل</h2>
        </div>
        <button class="btn btn-success" (click)="saveInvoice()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="icon"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            stroke-width="2"
            stroke="currentColor"
            fill="none"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path d="M5 12l5 5l10 -10" />
          </svg>
          حفظ الفاتورة
        </button>
      </div>
    </div>
  </div>
</div>
