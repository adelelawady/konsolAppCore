<div class="device-details" *ngIf="selectedDevice">
  <div class="device-details__header">
    <h2>{{ selectedDevice.name }}</h2>
    <div class="device-status" [ngClass]="{'active': isDeviceActive()}">
      {{ isDeviceActive() ? 'Active' : 'Inactive' }}
    </div>
  </div>

  <div class="device-details__content">
    <div class="orders-section" *ngIf="selectedDevice.session">
      <h3>Current Orders</h3>
      
      <div class="orders-list" *ngIf="orderItems.length > 0">
        <div class="order-item" *ngFor="let item of orderItems">
          <div class="item-info">
            <div class="item-name">{{ item.item?.name }}</div>
            <div class="item-details">
              <span class="qty">Qty: {{ item.userQty }}</span>
              <span class="price">{{ item.price }} EGP</span>
            </div>
          </div>
          <div class="item-total">
            {{ item.totalPrice }} EGP
          </div>
        </div>

        <div class="order-summary">
          <div class="summary-row">
            <span>Subtotal</span>
            <span>{{ getTotalPrice() }} EGP</span>
          </div>
          <div class="summary-row" *ngIf="getDiscount() > 0">
            <span>Discount</span>
            <span>-{{ getDiscount() }} EGP</span>
          </div>
          <div class="summary-row total">
            <span>Total</span>
            <span>{{ getNetPrice() }} EGP</span>
          </div>
        </div>
      </div>

      <div class="no-orders" *ngIf="orderItems.length === 0">
        No orders yet
      </div>
    </div>

    <div class="device-info">
      <div class="info-group">
        <label>Type</label>
        <span>{{ selectedDevice.type?.name }}</span>
      </div>

      <div class="info-group">
        <label>Status</label>
        <span>{{ getDeviceStatus() ? 'Active' : 'Inactive' }}</span>
      </div>

      <ng-container *ngIf="selectedDevice.session">
        <div class="info-group">
          <label>Started</label>
          <span>{{ selectedDevice.session.startTime | date:'shortTime' }}</span>
        </div>

        <div class="info-group">
          <label>Duration</label>
          <span>{{ getSessionDuration() }}</span>
        </div>
      </ng-container>
    </div>

    <div class="actions" *ngIf="!isDeviceActive()">
      <button 
        class="btn btn-primary" 
        (click)="startSession()" 
        [disabled]="isStartingSession"
      >
        <span class="spinner-border spinner-border-sm" *ngIf="isStartingSession"></span>
        <span>Start Session</span>
      </button>
    </div>
  </div>
</div>

<div class="no-device-selected" *ngIf="!selectedDevice">
  <p>Select a device to view details</p>
</div>
