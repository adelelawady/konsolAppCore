<div class="device-details" *ngIf="selectedDevice">
  <div class="device-details__header">
    <h2>{{ selectedDevice.name }}</h2>
    <div class="device-status" [ngClass]="{'active': isDeviceActive()}">
      {{ isDeviceActive() ? 'Active' : 'Inactive' }}
    </div>
  </div>

  <div class="device-details__content">
    <!-- Device Info - Condensed -->
    <div class="device-info">
      <div class="info-group">
        <label>Type</label>
        <span>{{ selectedDevice.type?.name }}</span>
      </div>

      <div class="info-group">
        <label>Started</label>
        <span>{{ selectedDevice.session?.startTime | date:'shortTime' }}</span>
      </div>

      <div class="info-group">
        <label>Duration</label>
        <span>{{ getSessionDuration() }}</span>
      </div>

      <div class="info-group">
        <label>Rate</label>
        <span>{{ selectedDevice.session?.type?.price }} EGP/hr</span>
      </div>
    </div>

    <!-- Cost Summary -->
    <div class="cost-summary" *ngIf="selectedDevice.session">
      <div class="cost-item session-time">
        <label><i class="fas fa-clock"></i>Time</label>
        <span class="value">{{ getSessionTimeCost() }} EGP</span>
      </div>
      <div class="cost-item orders-total">
        <label><i class="fas fa-shopping-cart"></i>Orders</label>
        <span class="value">{{ getOrdersTotal() }} EGP</span>
      </div>
      <div class="cost-item total">
        <label>Total</label>
        <span class="value">{{ getTotalCost() }} EGP</span>
      </div>
    </div>

    <!-- Orders Section -->
    <div class="orders-section" *ngIf="selectedDevice.session">
      <h3>Current Orders</h3>
      
      <div class="orders-list" *ngIf="orderItems.length > 0">
        <div class="order-item" *ngFor="let item of orderItems">
          <div class="item-info">
            <div class="item-name">{{ item.item?.name }}</div>
            <div class="item-details">
              <span class="qty">
                <button class="btn btn-sm btn-icon" (click)="updateDeviceOrder(item, false)"><i class="fas fa-minus"></i></button>
                Qty: {{ item.userQty }}
                <button class="btn btn-sm btn-icon" (click)="updateDeviceOrder(item, true)"><i class="fas fa-plus"></i></button>
              </span>
              <span class="price">{{ item.price }} EGP</span>
            </div>
          </div>
          <div class="item-total">
            {{ item.totalPrice }} EGP
          </div>
        </div>
      </div>

      <div class="no-orders" *ngIf="orderItems.length === 0">
        No orders yet
      </div>
    </div>

    <!-- Actions -->
    <div class="actions" *ngIf="!isDeviceActive()">
      <button 
        class="btn btn-primary" 
        (click)="startSession()" 
        [disabled]="isStartingSession"
      >
        <span class="spinner-border spinner-border-sm" *ngIf="isStartingSession"></span>
        <span>Start Session</span>
      </button>
    </div>
    <div class="actions" *ngIf="isDeviceActive()">
      <button 
        class="btn btn-danger" 
        (click)="stopSession()" 
        [disabled]="isStoppingSession"
      >
        <span class="spinner-border spinner-border-sm" *ngIf="isStoppingSession"></span>
        <span>Stop Session</span>
      </button>
    </div>
  </div>
</div>

<div class="no-device-selected" *ngIf="!selectedDevice">
  <p>Select a device to view details</p>
</div>
